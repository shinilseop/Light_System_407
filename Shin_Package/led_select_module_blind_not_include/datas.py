# 제어조건(변형가능)
import pandas as pd
import numpy as np

path = 'D:\\BunkerBuster\\Desktop\\shin_excel\\신조명 이후\\실험결과'

### 시스템 통합 변수
led_state_index = [[0]]
lux_state = None
control_df = None
cct_stand = None
lux_stand = None

### LED 조명 제어를 위한 변수
lock_step = 5  # LED 잠금시 잠굴 범위 값
similar_led_range = 1  # 방향성고려나 제어조도기준 선정할 때 영향도의 비슷한 범위를 위한 값
object_illum = 800
object_diff = 20
object_cal_diff = 20
isFinish = True
first_matched = False
can_control = False
is_exit = [False]
satisfy_flag = [True]
has_control_before = [True]
save_folder = "0"
accel = 4  # 5도 나쁘지 않을것 같음 다만 방향성고려가 제어에 들어가야 될듯함.
isJust_lock = 0
blind_serial = None

### 블라인드 제어를 위한 변수
cal_times = 0
blind_init_deg = -70
blind_init_position = 1420
blind_position = 1420
blind_deg = -70
cal_lux_time_limit = 500
blind_accel = 2
blind_lock_step = 3
blind_max = -2.8
blind_min = -70
more_illum_use_blind = True
blind_act_close = False
blind_serial = None

### 직사광 체크 변수
before_lux = [0, 0, 0,
              0, 0, 0,
              0, 0, 0]

# 저장용도 변수
df_record = []
led_state_case_limit = []
illum_add = []
illum_change_time = []
illum_satisfy_time = []
acs_cct = np.zeros(9)
II_illum = np.zeros(9)
IC_curr = np.zeros(10)
led_is_change = [False,
                 False, False, False, False, False, False,
                 False, False, False, False, False, False,
                 False, False, False, False, False, False,
                 False, False, False, False, False, False,
                 False, False, False, False, False, False]
cal_lux = [0, 0, 0,
           0, 0, 0,
           0, 0, 0]
ori_led_state = [0,
                 1, 1, 1, 1, 1, 1,
                 1, 1, 1, 1, 1, 1,
                 1, 1, 1, 1, 1, 1,
                 1, 1, 1, 1, 1, 1,
                 1, 1, 1, 1, 1, 1]

# new led control index
led_control = [[0, 0, 0, 0],
               [0, 1, 0, 0], [1, 0, 1, 0], [0, 2, 0, 0], [0, 3, 0, 0], [2, 1, 1, 0], [0, 4, 0, 0], [4, 0, 0, 1],
               [1, 3, 1, 0], [0, 5, 0, 0], [0, 6, 0, 0], [0, 5, 1, 0], [5, 0, 0, 2], [1, 6, 0, 0], [0, 7, 0, 0],
               [4, 2, 2, 0], [0, 8, 0, 0], [4, 3, 0, 2], [0, 9, 0, 0], [4, 4, 0, 2], [0, 9, 1, 0], [0, 10, 0, 0],
               [6, 3, 0, 2], [4, 5, 0, 2], [0, 11, 0, 0], [0, 12, 0, 0], [2, 8, 2, 0], [4, 5, 3, 1], [3, 9, 0, 1],
               [0, 13, 0, 0], [8, 4, 0, 2], [0, 14, 0, 0], [11, 1, 0, 3], [7, 2, 6, 0], [7, 6, 0, 2], [0, 12, 3, 0],
               [0, 15, 0, 0], [6, 4, 6, 0], [0, 16, 0, 0], [14, 0, 0, 4], [8, 6, 0, 4], [4, 12, 0, 2], [0, 18, 0, 0],
               [16, 0, 0, 4], [12, 0, 8, 0], [8, 8, 0, 4], [10, 4, 6, 0], [0, 20, 0, 0], [16, 0, 0, 6], [16, 0, 2, 4],
               [12, 0, 10, 0], [14, 0, 8, 0], [6, 12, 4, 0], [0, 18, 4, 0], [0, 22, 0, 0], [12, 0, 12, 0],
               [16, 4, 0, 4], [12, 8, 0, 4], [10, 10, 0, 4], [0, 24, 0, 0], [18, 0, 4, 4], [16, 6, 0, 4],
               [10, 12, 0, 4], [8, 14, 0, 4], [0, 24, 0, 2], [2, 24, 0, 0], [0, 26, 0, 0], [16, 6, 0, 6],
               [12, 12, 0, 4], [8, 16, 0, 4], [12, 14, 0, 2], [0, 24, 4, 0], [0, 28, 0, 0], [22, 2, 0, 6],
               [20, 0, 6, 4], [18, 6, 2, 4], [12, 12, 0, 6], [12, 12, 2, 4], [6, 18, 6, 0], [0, 24, 6, 0],
               [0, 30, 0, 0], [16, 0, 16, 0], [8, 12, 12, 0], [8, 20, 0, 4], [4, 28, 0, 0], [0, 32, 0, 0],
               [28, 0, 0, 8], [20, 0, 12, 4], [20, 0, 16, 0], [16, 8, 8, 4], [8, 24, 0, 4], [8, 20, 8, 0],
               [0, 36, 0, 0], [24, 0, 12, 4], [28, 4, 0, 8], [20, 12, 0, 8], [16, 12, 12, 0], [12, 24, 0, 4],
               [12, 24, 4, 0], [8, 28, 0, 4], [0, 36, 4, 0], [0, 40, 0, 0], [32, 0, 0, 12], [28, 0, 12, 4],
               [32, 4, 0, 8], [24, 8, 4, 8], [16, 20, 0, 8], [16, 24, 0, 4], [20, 16, 4, 4], [12, 24, 8, 0],
               [8, 32, 0, 4], [8, 36, 0, 0], [0, 44, 0, 0], [36, 0, 0, 12], [24, 0, 24, 0], [32, 8, 0, 8],
               [28, 12, 0, 8], [24, 12, 12, 0], [16, 24, 0, 8], [20, 24, 0, 4], [12, 24, 12, 0], [0, 48, 0, 0],
               [40, 0, 0, 12], [36, 4, 0, 12], [28, 12, 0, 12], [32, 12, 0, 8], [24, 4, 24, 0], [28, 12, 8, 4],
               [16, 20, 12, 4], [16, 28, 0, 8], [20, 24, 8, 0], [16, 32, 0, 4], [0, 48, 0, 4], [0, 52, 0, 0],
               [40, 4, 0, 12], [32, 0, 24, 0], [28, 4, 24, 0], [16, 24, 12, 4], [12, 40, 0, 4], [0, 52, 4, 0],
               [32, 4, 24, 0], [28, 8, 24, 0], [24, 24, 12, 0], [0, 48, 12, 0], [0, 60, 0, 0], [48, 0, 8, 8],
               [32, 8, 24, 0], [32, 16, 16, 0], [16, 32, 16, 0], [16, 40, 8, 0], [56, 0, 0, 16], [40, 0, 32, 0],
               [32, 16, 24, 0], [16, 32, 24, 0], [0, 72, 0, 0], [64, 0, 0, 16], [64, 0, 0, 16], [48, 0, 32, 0],
               [32, 32, 0, 16], [32, 16, 32, 0], [32, 32, 16, 0], [0, 80, 0, 0], [64, 0, 0, 24], [64, 8, 0, 16],
               [56, 8, 16, 8], [40, 32, 0, 16], [32, 40, 0, 16], [32, 48, 0, 8], [8, 72, 0, 8], [0, 80, 8, 0],
               [48, 0, 48, 0], [48, 32, 0, 16], [40, 40, 0, 16], [32, 48, 16, 0], [16, 80, 0, 0], [8, 88, 0, 0],
               [72, 0, 8, 24], [64, 0, 40, 0], [56, 8, 40, 0], [48, 40, 0, 16], [48, 32, 16, 8], [40, 56, 0, 8],
               [8, 88, 0, 8], [8, 96, 0, 0], [64, 0, 48, 0], [56, 0, 56, 0], [48, 16, 48, 0], [64, 32, 0, 16],
               [32, 64, 0, 16], [24, 72, 0, 16], [0, 112, 0, 0], [88, 0, 0, 32], [88, 8, 0, 24], [72, 24, 0, 24],
               [64, 32, 0, 24], [64, 40, 0, 16], [48, 56, 0, 16], [24, 80, 0, 16], [8, 104, 0, 8], [0, 112, 8, 0],
               [80, 0, 48, 0], [80, 16, 16, 16], [64, 16, 48, 0], [64, 48, 0, 16], [48, 64, 0, 16], [32, 80, 0, 16],
               [0, 128, 0, 0], [112, 0, 0, 32], [96, 16, 0, 32], [80, 0, 64, 0], [80, 48, 0, 16], [64, 48, 32, 0],
               [32, 96, 0, 16], [0, 144, 0, 0], [128, 0, 0, 32], [96, 0, 64, 0], [96, 16, 48, 0], [80, 32, 48, 0],
               [64, 64, 32, 0], [0, 160, 0, 0], [112, 0, 32, 32], [96, 0, 80, 0], [96, 16, 64, 0], [64, 48, 64, 0],
               [48, 80, 48, 0], [0, 176, 0, 0], [144, 0, 0, 48], [96, 0, 96, 0], [96, 16, 80, 0], [80, 48, 64, 0],
               [48, 96, 48, 0], [0, 192, 0, 0], [160, 0, 0, 48], [144, 16, 0, 48], [128, 0, 80, 0], [112, 16, 80, 0],
               [112, 32, 64, 0], [80, 64, 64, 0], [48, 96, 64, 0], [64, 112, 32, 0], [32, 176, 0, 0], [176, 0, 0, 48],
               [160, 16, 0, 48], [144, 0, 80, 0], [96, 16, 112, 0], [128, 32, 64, 0], [96, 64, 64, 0], [80, 80, 64, 0],
               [48, 128, 48, 0], [0, 224, 0, 0], [176, 0, 0, 64], [160, 32, 0, 48], [144, 48, 0, 48], [96, 32, 112, 0],
               [128, 48, 64, 0], [96, 112, 0, 32], [64, 144, 0, 32], [48, 160, 0, 32], [16, 208, 0, 16], [0, 240, 0, 0],
               [0, 255, 0, 0]]

led_control_lux = [0,
                   4.225231141, 7.907492831, 8.229552993, 12.14117585, 15.54701415, 16.6621163, 18.58951051,
                   19.85606475, 20.64786608, 23.6475702, 24.06492432, 26.59073857, 27.96832714, 28.11476516,
                   30.72791253, 31.79582827, 34.55848448, 35.77567164, 38.37962727, 39.81385854, 40.21619231,
                   41.84637784, 42.70159453, 43.95777648, 45.15823193, 48.66102722, 49.83191323, 50.8505034,
                   52.12299496, 53.44921877, 54.75959587, 55.96147308, 56.96647343, 57.56567116, 58.70916388,
                   59.23028574, 60.69736744, 61.66096349, 66.28578707, 67.3101352, 68.77638578, 69.68087088,
                   71.56155888, 73.42008412, 74.7526386, 75.3893575, 76.79930833, 78.39596377, 80.82604432, 81.81082769,
                   82.9335744, 83.88209864, 84.69263584, 85.61729261, 86.3552825, 87.52918207, 88.51145753, 89.80760579,
                   90.71222624, 95.87574045, 96.54686015, 97.62270544, 98.65453741, 99.39456532, 100.2999935,
                   101.5208245, 102.3882109, 103.2047439, 104.5758371, 105.8281314, 106.7461058, 107.4412864,
                   108.9970922, 109.5184711, 110.7216574, 111.2961681, 112.6757554, 113.4466633, 114.3488153,
                   115.363813, 116.8541824, 118.9522825, 120.4012344, 122.7105698, 123.5096515, 128.6510987,
                   129.4208833, 130.7362995, 132.8097536, 134.7987261, 136.6807654, 137.2384031, 144.0642395,
                   145.0297396, 146.7796079, 147.7069667, 148.8345653, 149.9976969, 150.7796364, 151.726194,
                   153.8136341, 156.6410452, 158.2787451, 159.891578, 160.8224582, 161.6932718, 162.4411994,
                   163.6141474, 164.4520473, 165.625174, 166.3077443, 167.1385232, 170.0780904, 172.9210364,
                   173.7667057, 174.2011088, 175.3558768, 176.4981804, 177.0817953, 179.155163, 180.6085069,
                   183.8815339, 185.2399207, 187.6461217, 188.360491, 189.5374772, 190.5307061, 191.8312691,
                   192.5276188, 193.6410255, 194.0825857, 195.1693841, 197.7334588, 199.5915751, 201.9059307,
                   203.5218786, 205.8529404, 209.9372034, 212.6486708, 217.8450756, 219.2644767, 221.4010062,
                   225.4541888, 227.5826922, 229.9584752, 233.9286203, 235.1212626, 239.7484762, 241.8142003,
                   254.5050403, 260.2794425, 263.4353453, 267.2775494, 271.7739251, 279.9769881, 281.9890843,
                   286.0055542, 289.7694672, 291.1156495, 294.9221891, 298.3093648, 309.5933592, 313.7398739,
                   317.8477535, 319.9845838, 322.5044942, 325.437763, 328.4076673, 330.6092663, 341.3865058,
                   345.5911921, 350.315717, 353.3370226, 356.2132944, 359.4438933, 366.8720728, 371.7498628,
                   375.1864793, 378.4423252, 380.7373886, 383.1466798, 386.5288259, 390.7197217, 396.6315884,
                   399.890393, 402.0150782, 405.1573609, 407.853398, 411.895413, 414.6675685, 418.4897925, 424.4069149,
                   427.6993884, 431.1155692, 434.2643208, 438.5690557, 441.2394925, 444.2929198, 446.4156104,
                   451.7476931, 454.2189112, 457.9265263, 459.2423875, 462.7292653, 466.458758, 472.3161788,
                   495.7037014, 503.0334724, 506.9506006, 513.8711478, 519.6670698, 524.1426998, 529.3385956,
                   550.0990027, 561.751357, 567.1466094, 571.2641699, 578.6503176, 585.7376483, 609.1827003,
                   615.5622898, 622.2529119, 629.3415169, 636.3299496, 643.2916698, 656.4526202, 669.9884607,
                   676.3960083, 683.7935527, 693.5386545, 699.4572373, 710.5948214, 716.4852773, 724.063393,
                   730.7569481, 735.2733329, 742.8797181, 748.9616476, 751.6928416, 757.1586067, 763.8823614,
                   770.7976439, 777.9894103, 784.6171275, 789.5878197, 797.6287489, 800.8762931, 808.7317485,
                   811.6165286, 815.0995317, 830.1048257, 834.7622645, 843.5081451, 846.9675803, 851.9722882,
                   858.0173538, 859.4095008, 865.3567121, 867.6569863, 913.9140978]

led_influ = [[],
             [0.444500975, 0.103028563, 0.027990011, 0.121815352, 0.05258102, 0.01770175, 0.037321206, 0.021957294,
              0.014601561],
             [0.651610608, 0.256074393, 0.050163815, 0.141541565, 0.09079982, 0.033372466, 0.043661362, 0.031957061,
              0.015641046],
             [0.350844592, 0.570376501, 0.131899075, 0.099603419, 0.150969267, 0.058729527, 0.035045137, 0.040601945,
              0.031559558],
             [0.132234869, 0.548231426, 0.362264795, 0.052864782, 0.140027706, 0.112019618, 0.023347839, 0.044292076,
              0.0403522],
             [0.05801242, 0.220826853, 0.623554462, 0.024707402, 0.076605095, 0.137220821, 0.014375991, 0.034285034,
              0.045025331],
             [0.029610583, 0.086795816, 0.468966683, 0.010925063, 0.03667627, 0.115946902, 0.014047732, 0.016868453,
              0.043987705],
             [0.442141135, 0.110977999, 0.030258805, 0.327552476, 0.094404414, 0.031324514, 0.091691787, 0.045344272,
              0.017723572],
             [0.628801045, 0.255742487, 0.053885074, 0.431745931, 0.2198564, 0.052944909, 0.099981515, 0.069400541,
              0.033290174],
             [0.331757126, 0.544262956, 0.136276831, 0.258200741, 0.400429853, 0.117305531, 0.080939216, 0.100681035,
              0.051242023],
             [0.131219087, 0.524406433, 0.328281217, 0.097472321, 0.379979359, 0.24994854, 0.051004622, 0.095541111,
              0.081002027],
             [0.049915316, 0.219831136, 0.610618871, 0.036774195, 0.177088898, 0.396841631, 0.028712256, 0.075182392,
              0.105573832],
             [0.029949784, 0.090943772, 0.46040522, 0.016834298, 0.063721531, 0.290290641, 0.019114903, 0.045694414,
              0.094155946],
             [0.196310436, 0.077698243, 0.027021567, 0.523679108, 0.118069259, 0.038319179, 0.237632797, 0.077297685,
              0.030168162],
             [0.246018217, 0.134324161, 0.038191135, 0.728645076, 0.275890963, 0.058390326, 0.277157469, 0.147024651,
              0.044678836],
             [0.155042604, 0.231738008, 0.070377144, 0.373312084, 0.62885601, 0.135671575, 0.19238618, 0.274916773,
              0.090172157],
             [0.080310428, 0.221488884, 0.171557112, 0.123166126, 0.614847421, 0.420869255, 0.091505033, 0.277364012,
              0.201695945],
             [0.0465306, 0.130509891, 0.236161857, 0.046924555, 0.235383865, 0.720349831, 0.04626569, 0.143330873,
              0.291129892],
             [0.027250743, 0.068288853, 0.208171959, 0.019130052, 0.085121796, 0.495431439, 0.023347839, 0.082030988,
              0.249788934],
             [0.080310428, 0.050110168, 0.020046758, 0.313735498, 0.089663893, 0.034049047, 0.487603402, 0.109271189,
              0.033290174],
             [0.086238262, 0.065470387, 0.026696955, 0.406248293, 0.197721211, 0.051083826, 0.670461253, 0.236793079,
              0.058025046],
             [0.06900823, 0.086141061, 0.044806693, 0.2382629, 0.380738, 0.121395967, 0.36308951, 0.612539396,
              0.142214294],
             [0.0465306, 0.083826796, 0.06634407, 0.098073601, 0.339669177, 0.264566995, 0.138886235, 0.60569067,
              0.373766162],
             [0.030965565, 0.063150608, 0.085278894, 0.037924672, 0.16669933, 0.466821835, 0.064025987, 0.269452174,
              0.696459088],
             [0.015085067, 0.043646081, 0.080257285, 0.016077692, 0.059941704, 0.337953791, 0.034392268, 0.101735109,
              0.474077421],
             [0.037900078, 0.030404199, 0.011791559, 0.128525163, 0.059941704, 0.027763795, 0.476348189, 0.104189643,
              0.03363481],
             [0.037900078, 0.036868286, 0.016963799, 0.132359602, 0.088527966, 0.043082548, 0.646533023, 0.243307976,
              0.054562045],
             [0.032652471, 0.043317823, 0.023936866, 0.100373002, 0.138895427, 0.072009443, 0.354797896, 0.548958994,
              0.1273644],
             [0.027920049, 0.040165584, 0.034952155, 0.05170701, 0.124505925, 0.13396647, 0.140190213, 0.550355805,
              0.361142076],
             [0.011165057, 0.036868286, 0.038658713, 0.027391344, 0.079245348, 0.157994107, 0.05929435, 0.252259194,
              0.638356123],
             [0.01305896, 0.023940112, 0.036573469, 0.011308032, 0.038565156, 0.160029316, 0.0322814, 0.104189643,
              0.438960429]]

# init LED state
led_state_0 = [0,
               0, 0, 0, 0, 0, 0,
               0, 0, 0, 0, 0, 0,
               0, 0, 0, 0, 0, 0,
               0, 0, 0, 0, 0, 0,
               0, 0, 0, 0, 0, 0]

# lock state
led_down_lock = [0,
                 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0,
                 0, 0, 0, 0, 0, 0]

led_up_lock = [0,
               0, 0, 0, 0, 0, 0,
               0, 0, 0, 0, 0, 0,
               0, 0, 0, 0, 0, 0,
               0, 0, 0, 0, 0, 0,
               0, 0, 0, 0, 0, 0]

sensor_lock = [0, 0, 0,
               0, 0, 0,
               0, 0, 0]

sensor_down_lock = [0, 0, 0,
                    0, 0, 0,
                    0, 0, 0]
sensor_up_lock = [0, 0, 0,
                  0, 0, 0,
                  0, 0, 0]
sensor_down_lock_cnt = [0]
sensor_up_lock_cnt = [0]
sensor_lock_cnt = [0]
# blind_lock=[0,0,0,
#             0,0,0,
#             0,0,0]
blind_lock = 0

# led inflence
### 함수통해서 자동으로 생성 0.155 이상인 제어지표 가지고 와서 제작
sensor_influence_threshold = 0.155
sensor_influence_all = []
sensor_influence_value_all = []
# sensor_influence_all = [[2, 8, 1, 7, 3, 9, 14, 13, 15],
#                         [3, 4, 9, 10, 2, 8, 15, 16, 5, 11],
#                         [5, 11, 6, 12, 4, 10, 17, 18, 16],
#                         [14, 13, 8, 20, 15, 7, 19, 9, 21],
#                         [15, 16, 9, 21, 10, 22, 14, 17, 8, 20, 11, 23],
#                         [17, 18, 23, 16, 11, 24, 12, 22, 10],
#                         [20, 26, 19, 25, 21, 27, 14, 13, 15],
#                         [21, 22, 28, 27, 16, 15, 23, 29, 26, 20],
#                         [23, 29, 24, 30, 22, 28, 17, 18, 16]]
# sensor_influence_all = [[8, 2, 7, 9, 1, 3, 14, 15, 13],
#                         [4, 3, 9, 10, 8, 5, 11, 2, 15, 16],
#                         [5, 11, 12, 6, 10, 4, 17, 16, 18],
#                         [14, 8, 20, 15, 13, 7, 19, 21, 9],
#                         [15, 16, 9, 22, 21, 10, 14, 17, 8, 11, 20],
#                         [17, 11, 23, 16, 18, 24, 22, 10, 12],
#                         [20, 26, 19, 21, 27, 25, 14, 13, 15],
#                         [28, 27, 21, 22, 23, 20, 29, 26, 15, 16],
#                         [23, 29, 24, 28, 22, 30, 17, 16, 18]]
# sensor_influence_value_all = [[94.5, 94.4, 58.3, 58.2, 58.1, 58.0, 29.4, 24.2, 24.1],
#                               [76.7, 76.6, 76.6, 76.5, 38.1, 38.0, 38.0, 37.9, 26.8, 26.8],
#                               [94.4, 94.4, 58.2, 58.1, 58.1, 58.0, 29.4, 24.2, 24.2],
#                               [94.5, 62.1, 62.1, 58.1, 58.1, 41.2, 41.2, 41.2, 41.1],
#                               [88.9, 88.3, 54.6, 54.4, 54.1, 54.0, 34.4, 34.4, 25.9, 25.8, 24.5],
#                               [94.6, 62.2, 62.2, 58.2, 58.1, 41.3, 41.2, 41.1, 41.1],
#                               [94.8, 94.3, 58.1, 58.1, 58.1, 58.0, 29.6, 24.2, 24.2],
#                               [76.7, 76.6, 76.5, 76.5, 38.1, 38.1, 38.0, 37.9, 26.8, 26.8],
#                               [94.7, 94.3, 58.2, 58.2, 58.0, 58.0, 29.5, 24.2, 24.2]]

### 사용안함
# sensor_influence_individual_part = [[8, 2, 7, 1],
#                                     [4, 3, 9, 10],
#                                     [5, 11, 12, 6],
#                                     [14, 13],
#                                     [15, 16],
#                                     [17, 18],
#                                     [20, 26, 19, 25],
#                                     [28, 27, 21, 22],
#                                     [23, 29, 24, 30]]
# sensor_influence_value_individual_part = [[94.5, 94.4, 58.3, 58.1],
#                                           [76.7, 76.6, 76.6, 76.5],
#                                           [94.4, 94.4, 58.2, 58.1],
#                                           [94.5, 58.1],
#                                           [88.9, 88.3],
#                                           [94.6, 58.1],
#                                           [94.8, 94.3, 58.1, 58.0],
#                                           [76.7, 76.6, 76.5, 76.5],
#                                           [94.7, 94.3, 58.2, 58.0]]

sensor_sum_middle_threshold = 0.49
sensor_sum_other_threshold = 0.4
sensor_influence_sum_part = [[8, 2, 7, 1],
                             [10, 9, 3, 4],
                             [11, 5, 12, 6],
                             [14, 13],
                             [15, 16],
                             [17, 18],
                             [20, 26, 19, 25],
                             [22, 21, 28, 27],
                             [23, 29, 24, 30]]
sensor_influence_sum_value_part = [[253.8, 181.8, 140.4, 105.5],
                                   [286.6, 286.3, 208.1, 207.5],
                                   [253.9, 181.6, 140.9, 105.5],
                                   [238.1, 140.0],
                                   [289.9, 289.3],
                                   [238.1, 140.7],
                                   [252.4, 181.6, 141.2, 105.0],
                                   [285.9, 285.6, 207.7, 207.5],
                                   [252.7, 181.4, 141.5, 105.1]]

sensor_influence_sum_part_reverse = [[1, 7, 2, 8],
                                     [4, 3, 9, 10],
                                     [6, 12, 5, 11],
                                     [13, 14],
                                     [16, 15],
                                     [18, 17],
                                     [25, 19, 26, 20],
                                     [27, 28, 21, 22],
                                     [30, 24, 29, 23]]
sensor_influence_sum_value_part_reverse = [[105.5, 140.4, 181.8, 253.8],
                                           [207.5, 208.1, 286.3, 286.6],
                                           [105.5, 140.9, 181.6, 253.9],
                                           [140.0, 238.1],
                                           [289.3, 289.9],
                                           [140.7, 238.1],
                                           [105.0, 141.2, 181.6, 252.4],
                                           [285.9, 285.6, 207.7, 207.5],
                                           [105.1, 141.5, 181.4, 252.7]]
### 사용안함
#######################new sum part
# sensor_influence_sum_part_reverse = [[1, 7, 2, 3, 8, 9],
#                                      [4, 3, 9, 10],
#                                      [6, 12, 5, 4, 11, 10],
#                                      [13, 14, 20, 8, 15],
#                                      [21, 22, 9, 10, 16, 15],
#                                      [18, 17, 23, 11, 16],
#                                      [25, 19, 26, 27, 20, 21],
#                                      [27, 28, 21, 22],
#                                      [30, 24, 29, 28, 23, 22]]
# sensor_influence_value_sum_part_reverse = [[105.5, 140.4, 181.8, 208.1, 253.8, 286.3],
#                                            [207.5, 208.1, 286.3, 286.6],
#                                            [105.5, 140.9, 181.6, 207.5, 253.9, 286.6],
#                                            [140.0, 238.1, 252.4, 253.8, 289.9],
#                                            [285.6, 285.9, 286.3, 286.6, 289.3, 289.9],
#                                            [140.7, 238.1, 252.7, 253.9, 289.3],
#                                            [105.0, 141.2, 181.6, 207.5, 252.4, 285.6],
#                                            [285.9, 285.6, 207.7, 207.5],
#                                            [105.1, 141.5, 181.4, 207.7, 252.7, 285.9]]
#
# sensor_influence_sum_all = [[15, 9, 8, 14, 3, 2, 7, 13, 1],
#                             [15, 16, 10, 9, 11, 8, 3, 4, 2, 5],
#                             [16, 10, 11, 17, 4, 5, 12, 18, 6],
#                             [15, 9, 21, 8, 20, 14, 19, 7, 13],
#                             [15, 16, 10, 9, 22, 21, 11, 8, 23, 20, 17, 14],
#                             [16, 10, 22, 11, 23, 17, 24, 12, 18],
#                             [15, 21, 20, 14, 27, 26, 19, 13, 25],
#                             [15, 16, 22, 21, 23, 20, 28, 27, 26, 29],
#                             [16, 22, 23, 17, 28, 29, 24, 18, 30]]
# sensor_influence_value_sum_all = [
#     [289.8907749, 286.3490037, 253.8269373, 238.0903321, 208.1389668, 181.7594834, 140.4187454, 140.0373432,
#      105.4903321],
#     [289.8907749, 289.3086347, 286.6149815, 286.3490037, 253.857048, 253.8269373, 208.1389668, 207.5430258, 181.7594834,
#      181.6352768],
#     [289.3086347, 286.6149815, 253.857048, 238.1442804, 207.5430258, 181.6352768, 140.921845, 140.7148339, 105.500369],
#     [289.8907749, 286.3490037, 285.6037638, 253.8269373, 252.4343173, 238.0903321, 141.2405166, 140.4187454,
#      140.0373432],
#     [289.8907749, 289.3086347, 286.6149815, 286.3490037, 285.9199262, 285.6037638, 253.857048, 253.8269373, 252.7416974,
#      252.4343173, 238.1442804, 238.0903321],
#     [289.3086347, 286.6149815, 285.9199262, 253.857048, 252.7416974, 238.1442804, 141.5391144, 140.921845, 140.7148339],
#     [289.8907749, 285.6037638, 252.4343173, 238.0903321, 207.4828044, 181.6390406, 141.2405166, 140.0373432,
#      105.0349077],
#     [289.8907749, 289.3086347, 285.9199262, 285.6037638, 252.7416974, 252.4343173, 207.701107, 207.4828044, 181.6390406,
#      181.4069373],
#     [289.3086347, 285.9199262, 252.7416974, 238.1442804, 207.701107, 181.4069373, 141.5391144, 140.7148339,
#      105.0562362]]
# sersor_influence_sum_all_reverse = []
# sersor_influence_value_sum_all_reverse = []

### 사용안함
# sensor_influence_sum = [15, 16, 10, 9, 22, 21, 11, 8, 23, 20, 17, 14, 3, 28, 4, 27, 2, 26, 5, 29, 24, 19, 24, 19, 12,
#                         18, 7, 13, 6, 1, 30, 25]
# sensor_influence_value_sum = [2.898907749, 2.893086347, 2.866149815, 2.863490037, 2.859199262, 2.856037638, 2.53857048,
#                               2.538269373, 2.527416974, 2.524343173,
#                               2.381442804, 2.380903321, 2.081389668, 2.07701107, 2.075430258, 2.074828044, 1.817594834,
#                               1.816390406, 1.816352768, 1.814069373,
#                               1.415391144, 1.412405166, 1.40921845, 1.407148339, 1.404187454, 1.400373432, 1.05500369,
#                               1.054903321, 1.050562362, 1.050349077]

### 사용안함 ( 교체함 : sensor_influence_all 과 겹치기 때문에)
# inf_ind = [[8, 2, 7, 9, 1, 3, 14, 15, 13],
#            [4, 3, 9, 10, 8, 5, 11, 2, 15, 16],
#            [5, 11, 12, 6, 10, 4, 17, 16, 18],
#            [14, 8, 20, 15, 13, 7, 19, 21, 9],
#            [15, 16, 9, 22, 21, 10, 14, 17, 8, 11, 20, 23],
#            [17, 11, 23, 16, 18, 24, 22, 10, 12],
#            [20, 26, 19, 21, 27, 25, 14, 13, 15],
#            [28, 27, 21, 22, 23, 20, 29, 26, 15, 16],
#            [23, 29, 24, 28, 22, 30, 17, 16, 18]]
#
# inf_ind_value = [[94.5, 94.4, 58.3, 58.2, 58.1, 58.0, 29.4, 24.2, 24.1],
#                  [76.7, 76.6, 76.6, 76.5, 38.1, 38.0, 38.0, 37.9, 26.8, 26.8],
#                  [94.4, 94.4, 58.2, 58.1, 58.1, 58.0, 29.4, 24.2, 24.2],
#                  [94.5, 62.1, 62.1, 58.1, 58.1, 41.2, 41.2, 41.2, 41.1],
#                  [88.9, 88.3, 54.6, 54.4, 54.1, 54.0, 34.4, 34.4, 25.9, 25.8, 24.5, 24.4],
#                  [94.6, 62.2, 62.2, 58.2, 58.1, 41.3, 41.2, 41.1, 41.1],
#                  [94.8, 94.3, 58.1, 58.1, 58.1, 58.0, 29.6, 24.2, 24.2],
#                  [76.7, 76.6, 76.5, 76.5, 38.1, 38.1, 38.0, 37.9, 26.8, 26.8],
#                  [94.7, 94.3, 58.2, 58.2, 58.0, 58.0, 29.5, 24.2, 24.2]]
# inf_sum = [[15, 9, 8, 14, 3, 2, 7, 13, 1],
#            [15, 16, 10, 9, 11, 8, 3, 4, 2, 5, 14, 17],
#            [16, 10, 11, 17, 4, 5, 12, 18, 6],
#            [15, 9, 21, 8, 20, 14, 19, 7, 13],
#            [15, 16, 10, 9, 22, 21, 11, 8, 23, 20, 17, 14],
#            [16, 10, 22, 11, 23, 17, 24, 12, 18],
#            [15, 21, 20, 14, 27, 26, 19, 13, 25],
#            [15, 16, 22, 21, 23, 20, 28, 27, 26, 29, 17, 14],
#            [16, 22, 23, 17, 28, 29, 24, 18, 30]]
# inf_sum_value = [
#     [289.89, 286.34, 253.82, 238.09, 208.13, 181.75, 140.41, 140.03, 105.49],
#     [289.89, 289.3, 286.61, 286.34, 253.85, 253.82, 208.13, 207.54, 181.75, 181.63, 238.09, 238.14],
#     [289.3, 286.61, 253.85, 238.14, 207.54, 181.63, 140.92, 140.71, 105.5],
#     [289.89, 286.35, 285.6, 253.83, 252.43, 238.09, 141.24, 140.42, 140.04],
#     [289.89, 289.31, 286.61, 286.35, 285.92, 285.6, 253.86, 253.83, 252.74, 252.43, 238.14, 238.09],
#     [289.31, 286.61, 285.92, 253.86, 252.74, 238.14, 141.54, 140.92, 140.71],
#     [289.89, 285.6, 252.43, 238.09, 207.48, 181.64, 141.24, 140.04, 105.03],
#     [289.89, 289.31, 285.92, 285.6, 252.74, 252.43, 207.7, 207.48, 181.64, 181.41, 238.14, 238.09],
#     [289.31, 285.92, 252.74, 238.14, 207.7, 181.41, 141.54, 140.71, 105.06]]

inf_df = {'ind': []}
### 사용안함
# for i in range(len(sensor_influence_all)):
#     inf_df['ind'].append(
#         pd.DataFrame([x for x in zip(sensor_influence_all[i], sensor_influence_value_all[i])],columns=['led', 'value']))
#     inf_df['ind'][i] = inf_df['ind'][i].sort_values(by=['value'], axis=0, ascending=False)
dir_inf = []
dir_inf_temp = []
dir_inf_df = {'ind': [0]}

dir_inf_temp.append({'ind': {'right': [2, 3, 8, 9, 14, 15],
                             'rightdown': [8, 9, 14, 15],
                             'down': [7, 8, 9, 13, 14, 15]}})  # 1
dir_inf_temp.append({'ind': {'right': [4, 5, 10, 11, 16],
                             'rightdown': [10, 11, 16],
                             'down': [9, 10, 15, 16],
                             'leftdown': [8, 9, 15],
                             'left': [2, 3, 8, 9, 15]}})  # 2
dir_inf_temp.append({'ind': {'down': [10, 11, 12, 16, 17, 18],
                             'leftdown': [10, 11, 16, 17],
                             'left': [4, 5, 10, 11, 16, 17]}})  # 3
dir_inf_temp.append({'ind': {'up': [7, 8, 9, 13, 14, 15],
                             'rightup': [8, 9, 14, 15],
                             'right': [8, 9, 14, 15, 20, 21],
                             'rightdown': [14, 15, 20, 21],
                             'down': [13, 14, 15, 19, 20, 21]}})  # 4
dir_inf_temp.append({'ind': {'up': [9, 10, 15, 16],
                             'rightup': [10, 11, 16, 17],
                             'right': [10, 11, 16, 17, 22, 23],
                             'rightdown': [16, 17, 22, 23],
                             'down': [15, 16, 21, 22],
                             'leftdown': [14, 15, 20, 21],
                             'left': [8, 9, 14, 15, 20, 21],
                             'leftup': [8, 9, 14, 15]}})  # 5
dir_inf_temp.append({'ind': {'up': [10, 11, 12, 16, 17, 18],
                             'down': [16, 17, 18, 22, 23, 24],
                             'leftdown': [16, 17, 22, 23],
                             'left': [10, 11, 16, 17, 22, 23],
                             'leftup': [10, 11, 16, 17]}})  # 6
dir_inf_temp.append({'ind': {'up': [13, 14, 15, 19, 20, 21],
                             'rightup': [14, 15, 20, 21],
                             'right': [14, 15, 20, 21, 26, 27]}})  # 7
dir_inf_temp.append({'ind': {'up': [15, 16, 21, 22],
                             'rightup': [16, 22, 23],
                             'right': [16, 22, 23, 28, 29],
                             'left': [15, 20, 21, 26, 27],
                             'leftup': [15, 20, 21]}})  # 8
dir_inf_temp.append({'ind': {'up': [16, 17, 18, 22, 23, 24],
                             'left': [16, 17, 22, 23, 28, 29],
                             'leftup': [16, 17, 22, 23]}})  # 9

movement = [{'x': [0, 1],
             'y': [0, 1]},  # 1
            {'x': [0, 1, -1],
             'y': [0, 1]},  # 2
            {'x': [0, -1],
             'y': [0, 1]},  # 3
            {'x': [0, 1],
             'y': [0, 1, -1]},  # 4
            {'x': [0, 1, -1],
             'y': [0, 1, -1]},  # 5
            {'x': [0, -1],
             'y': [0, 1, -1]},  # 6
            {'x': [0, 1],
             'y': [0, -1]},  # 7
            {'x': [0, 1, -1],
             'y': [0, -1]},  # 8
            {'x': [0, -1],
             'y': [0, -1]}]  # 9
direction = {'lr': {0: '', -1: 'left', 1: 'right'},
             'ud': {0: '', -1: 'up', 1: 'down'}}

# 초기 변수 설정
wait_curr = 0
wait_illum = [0, 0, 0, 0, 0, 0, 0, 0, 0]

# 추가변수
led_state_lux = [0,
                 24, 59, 31, 32, 112, 24,
                 24, 231, 72, 72, 169, 24,
                 24, 24, 24, 24, 24, 24,
                 24, 231, 68, 68, 169, 24,
                 24, 45, 29, 29, 135, 24]

led_state_case = [
    [0,
     1, 1, 1, 1, 1, 1,
     1, 1, 1, 1, 1, 1,
     1, 1, 1, 1, 1, 1,
     1, 1, 1, 1, 1, 1,
     1, 1, 1, 1, 1, 1],
    [0,
     230, 230, 230, 230, 230, 230,
     230, 230, 230, 230, 230, 230,
     230, 230, 230, 230, 230, 230,
     230, 230, 230, 230, 230, 230,
     230, 230, 230, 230, 230, 230],
    [0,
     230, 230, 230, 230, 230, 230,
     230, 230, 230, 230, 230, 230,
     1, 1, 1, 1, 1, 1,
     1, 1, 1, 1, 1, 1,
     1, 1, 1, 1, 1, 1],
    [0,
     1, 1, 1, 1, 1, 1,
     1, 1, 1, 1, 1, 1,
     1, 1, 1, 1, 1, 1,
     230, 230, 230, 230, 230, 230,
     230, 230, 230, 230, 230, 230]]
led_state_case_limit = [300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300, 300,
                        300]
led_max_state = [0,
                 1, 4, 1, 2, 5, 1,
                 1, 9, 4, 4, 7, 1,
                 1, 1, 1, 1, 1, 1,
                 1, 9, 3, 3, 8, 2,
                 1, 4, 1, 2, 8, 2]

led_state_lux = [0,
                 24, 98, 46, 37, 139, 24,
                 24, 200, 78, 73, 139, 24,
                 24, 24, 38, 24, 24, 24,
                 24, 201, 68, 66, 148, 24,
                 24, 88, 28, 45, 166, 24]

# led_state_lux = [0,
#                  24, 98, 46, 37, 139, 24,
#                  24, 200, 78, 73, 139, 24,
#                  24, 24, 38, 24, 24, 24,
#                  24, 201, 68, 66, 148, 24,
#                  24, 88, 28, 45, 166, 24]

# led_state = [0,
#              24,  238,   30,   28,  229,   24,
#              24,  236,  138,  132,  265,   24,
#              24,   82,   73,   24,   24,   24,
#              29,  301,  101,  139,  288,   24,
#              24,  214,   24,   24,  246,   24]
illum_add = [100, 200, 200,
             0, 100, 200,
             0, 0, 100]
illum_add = [0, 0, 0,
             0, 0, 0,
             0, 0, 0]

# 조도 계산 시뮬레이션을 위한 영향도 (추후 수정예정)
led_ind_inf = [[],  # 0번
               [0.581236900369004, 0.130140959409594, 0.0302361623616236, 0.154492988929889, 0.0557926199261993,
                0.0207011070110701, 0.0489173431734317, 0.0191453874538745, 0.014239852398524],
               # 1번
               [0.944045756457565, 0.379093726937269, 0.0719018450184502, 0.19019926199262, 0.104270848708487,
                0.0303867158671587, 0.0519785977859779, 0.030010332103321, 0.0157077490774908],
               # 2번
               [0.580208118081181, 0.766053874538746, 0.187639852398524, 0.154831734317343, 0.187112915129151,
                0.0857276752767528, 0.048189667896679, 0.0507490774907749, 0.0208767527675277],
               # 3번
               [0.187664944649447, 0.766681180811808, 0.580157933579336, 0.086329889298893, 0.179785977859779,
                0.154467896678967, 0.0212154981549816, 0.0507992619926199, 0.0483276752767528],
               # 4번
               [0.0720022140221402, 0.379545387453875, 0.944359409594096, 0.0302612546125461, 0.103417712177122,
                0.189885608856089, 0.0160339483394834, 0.0288560885608856, 0.0519911439114391],
               # 5번
               [0.030010332103321, 0.130768265682657, 0.580923247232472, 0.0201741697416974, 0.0562442804428044,
                0.154480442804428, 0.0147542435424354, 0.0194214022140221, 0.0482273062730627],
               # 6번
               [0.583081180811808, 0.130391881918819, 0.0264723247232472, 0.411563099630996, 0.0815874538745388,
                0.0263217712177122, 0.100431734317343, 0.0261084870848708, 0.018229520295203],
               # 7번
               [0.944823616236162, 0.380862730627306, 0.0687025830258303, 0.621459778597786, 0.259064944649447,
                0.054989667896679, 0.12020442804428, 0.0659675276752767, 0.0221940959409594],
               # 8번
               [0.581952029520295, 0.766078966789668, 0.174980811808118, 0.411036162361624, 0.546132841328413,
                0.143552767527675, 0.101059040590406, 0.109590405904059, 0.0291070110701107],
               # 9번
               [0.186686346863469, 0.765112915129151, 0.58099852398524, 0.14370332103321, 0.53969667896679,
                0.410960885608856, 0.0291948339483395, 0.109138745387454, 0.100657564575646],
               # 10번
               [0.0727549815498155, 0.38039852398524, 0.944271586715867, 0.0539608856088561, 0.258023616236162,
                0.622087084870849, 0.0215918819188192, 0.0653276752767528, 0.120154243542435],
               # 11번
               [0.0296590405904059, 0.130053136531365, 0.581512915129151, 0.0251173431734317, 0.0866184501845018,
                0.411412546125461, 0.0178907749077491, 0.0260833948339483, 0.100870848708487],
               # 12번
               [0.241224354243542, 0.0763682656826568, 0.0222442804428044, 0.580973431734317, 0.110230258302583,
                0.0282287822878229, 0.241625830258303, 0.0764937269372694, 0.0229845018450184],
               # 13번
               [0.294244280442804, 0.17770332103321, 0.0382782287822878, 0.944986715867159, 0.343914391143911,
                0.0703837638376384, 0.295850184501845, 0.176988191881919, 0.0385542435424354],
               # 14번
               [0.242064944649447, 0.268311439114391, 0.11250110701107, 0.581186715867159, 0.889419926199262,
                0.18130405904059, 0.2424036900369, 0.267734317343173, 0.113981549815498],
               # 15번
               [0.112588929889299, 0.268461992619926, 0.241926937269373, 0.181793357933579, 0.882908487084871,
                0.581563099630996, 0.11350479704797, 0.268211070110701, 0.242127675276753],
               # 16번
               [0.0387047970479705, 0.177188929889299, 0.294281918819188, 0.0705719557195572, 0.343939483394834,
                0.945726937269373, 0.0381653136531365, 0.177916605166052, 0.294946863468635],
               # 17번
               [0.0228339483394834, 0.0756907749077491, 0.241876752767528, 0.0276642066420664, 0.116365313653137,
                0.58119926199262, 0.0231726937269373, 0.0763306273062731, 0.242014760147601],
               # 18번
               [0.100030258302583, 0.0259955719557196, 0.0181166051660517, 0.412064944649446, 0.0933682656826568,
                0.0247535055350554, 0.581412546125461, 0.129350553505535, 0.0273129151291513],
               # 19번
               [0.119790405904059, 0.0652774907749077, 0.0217047970479705, 0.621459778597786, 0.244912915129151,
                0.0540361623616236, 0.947935055350554, 0.380511439114391, 0.0687151291512915],
               # 20번
               [0.100180811808118, 0.110054612546125, 0.0294833948339483, 0.411763837638376, 0.541152029520295,
                0.143389667896679, 0.580747601476015, 0.76510036900369, 0.174165313653137],
               # 21번
               [0.0288686346863469, 0.110330627306273, 0.0997793357933579, 0.14410479704797, 0.544338745387454,
                0.412215498154982, 0.174729889298893, 0.765037638376384, 0.579794095940959],
               # 22번
               [0.0221940959409594, 0.0654154981549815, 0.119915867158672, 0.0547512915129151, 0.245339483394834,
                0.622074538745387, 0.0689660516605166, 0.38130184501845, 0.947458302583026],
               # 23번
               [0.0184177121771218, 0.0253431734317343, 0.0998546125461255, 0.0250546125461255, 0.095049446494465,
                0.412742435424354, 0.0274885608856089, 0.129915129151291, 0.581525461254613],
               # 24번
               [0.0481269372693727, 0.0192332103321033, 0.0139763837638376, 0.155120295202952, 0.0528944649446494,
                0.0202118081180812, 0.579819188191882, 0.131521033210332, 0.0294457564575646],
               # 25번
               [0.0516147601476015, 0.0296464944649446, 0.0151933579335793, 0.189584501845018, 0.105249446494465,
                0.0305749077490775, 0.942878966789668, 0.379319557195572, 0.0723284132841328],
               # 26번
               [0.0489047970479705, 0.0503350553505535, 0.0212405904059041, 0.155459040590406, 0.178368265682657,
                0.0856022140221402, 0.58129963099631, 0.766267158671587, 0.187351291512915],
               # 27번
               [0.0211276752767528, 0.0502221402214022, 0.0486036900369004, 0.0862546125461255, 0.180438376383764,
                0.154806642066421, 0.187175645756458, 0.766806642066421, 0.581575645756458],
               # 28번
               [0.0152560885608856, 0.0291948339483395, 0.0523926199261993, 0.0301483394833948, 0.103078966789668,
                0.18949667896679, 0.0717763837638376, 0.379583025830258, 0.943142435424354],
               # 29번
               [0.0141394833948339, 0.0193837638376384, 0.0487291512915129, 0.0201490774907749, 0.0532332103321033,
                0.155383763837638, 0.0290693726937269, 0.130228782287823, 0.580245756457565]]  # 30번

if __name__ == '__main__':
    print(len(led_control))
